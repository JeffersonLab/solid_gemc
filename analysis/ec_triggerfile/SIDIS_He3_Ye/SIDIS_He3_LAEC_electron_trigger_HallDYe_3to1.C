// refer to http://hallaweb.jlab.org/12GeV/SoLID/download/sim/talk/solid_SIDIS_background_zwzhao_20131118.pdf
// FAEC e trigger cut on Q2=1 curve on slide 5
// FAEC e trigger cut R edge 90,105,115,130,150,200,230 cm
// FAEC e trigger cut P value 5,4,3,2,1,2 GeV
// LAEC e trigger cut P>3GeV on slide 3

double large_electron_trigger_low_R[3]={80,105,115};
double large_electron_trigger_high_R[3]={105,115,140};

double large_electron_trigger_low_P[24]={1.575,	1.725,	1.875,	2.025,	2.175,	2.325,	2.475,	2.625,	2.775,	2.925,	3.075,	3.225,	3.375,	3.525,	3.675,	3.825,	3.975,	4.125,	4.275, 4.425,4.575,4.725,4.875,5.025};
double large_electron_trigger_high_P[24]={1.725,1.875,	2.025,	2.175,	2.325,	2.475,	2.625,	2.775,	2.925,	3.075,	3.225,	3.375,	3.525,	3.675,	3.825,	3.975,	4.125,	4.275,	4.425, 4.575,4.725,4.875,5.025,5.175};

/*double large_electron_trigger_e_low_eff[3][20]= { 
{ 0.006,0.001,0.012,0.007,0.021,0.076,0.318,0.624,0.855,0.938,0.977,0.981,0.990,0.995,0.989,0.991,0.995,0.999,0.997,0.996},{ 0.007,0.000,0.004,0.013,0.009,0.056,0.258,0.598,0.843,0.944,0.986,0.980,0.986,0.991,0.997,0.996,0.995,0.995,0.995,0.996},{ 0.001,0.002,0.003,0.009,0.032,0.138,0.344,0.553,0.703,0.763,0.816,0.838,0.858,0.870,0.888,0.897,0.910,0.907,0.914,0.939}
};*/
//3GeV
/*double large_electron_trigger_e_low_eff[3][24]= {
{ 0.020,0.020,0.020,0.021,0.046,0.075,0.309,0.643,0.859,0.940,0.987,0.989,0.993,0.991,0.988,0.987,0.990,0.993,0.993,0.993,0.993,0.996,0.993,0.995},
{ 0.020,0.020,0.020,0.021,0.046,0.075,0.309,0.643,0.859,0.940,0.987,0.989,0.993,0.991,0.988,0.987,0.990,0.993,0.993,0.993,0.993,0.996,0.993,0.995},
{ 0.020,0.020,0.020,0.021,0.046,0.075,0.309,0.643,0.859,0.940,0.987,0.989,0.993,0.991,0.988,0.987,0.990,0.993,0.993,0.993,0.993,0.996,0.993,0.995}
};*/

//3.3 GeV threshold
/*double large_electron_trigger_e_low_eff[3][24]= {
{ 0.012,0.019,0.011,0.017,0.030,0.022,0.048,0.121,0.387,0.692,0.874,0.945,0.975,0.987,0.983,0.987,0.986,0.993,0.990,0.992,0.993,0.996,0.993,0.994},
{ 0.012,0.019,0.011,0.017,0.030,0.022,0.048,0.121,0.387,0.692,0.874,0.945,0.975,0.987,0.983,0.987,0.986,0.993,0.990,0.992,0.993,0.996,0.993,0.994},
{ 0.012,0.019,0.011,0.017,0.030,0.022,0.048,0.121,0.387,0.692,0.874,0.945,0.975,0.987,0.983,0.987,0.986,0.993,0.990,0.992,0.993,0.996,0.993,0.994},
};
//3.3 GeV
double large_electron_trigger_e_high_eff[3][24]={ { 0.019,0.012,0.019,0.028,0.022,0.051,0.124,0.406,0.706,0.875,0.948,0.975,0.986,0.985,0.984,0.988,0.993,0.990,0.991,0.995,0.995,0.995,0.994,0.995},{ 0.019,0.012,0.019,0.028,0.022,0.051,0.124,0.406,0.706,0.875,0.948,0.975,0.986,0.985,0.984,0.988,0.993,0.990,0.991,0.995,0.995,0.995,0.994,0.995},{ 0.019,0.012,0.019,0.028,0.022,0.051,0.124,0.406,0.706,0.875,0.948,0.975,0.986,0.985,0.984,0.988,0.993,0.990,0.991,0.995,0.995,0.995,0.994,0.995}
};*/
//3.4 GeV
double large_electron_trigger_e_low_eff[3][24]= {
{0.009,0.017,0.011,0.017,0.023,0.021,0.040,0.065,0.225,0.534,0.789,0.910,0.963,0.985,0.979,0.983,0.986,0.993,0.990,0.992,0.993,0.996,0.993,0.994},
{0.009,0.017,0.011,0.017,0.023,0.021,0.040,0.065,0.225,0.534,0.789,0.910,0.963,0.985,0.979,0.983,0.986,0.993,0.990,0.992,0.993,0.996,0.993,0.994},
{0.009,0.017,0.011,0.017,0.023,0.021,0.040,0.065,0.225,0.534,0.789,0.910,0.963,0.985,0.979,0.983,0.986,0.993,0.990,0.992,0.993,0.996,0.993,0.994}
};

double large_electron_trigger_e_high_eff[3][24]={
{ 0.017,0.012,0.017,0.023,0.021,0.042,0.064,0.238,0.554,0.794,0.914,0.963,0.983,0.979,0.982,0.988,0.993,0.990,0.991,0.995,0.995,0.995,0.994,0.995},
{ 0.017,0.012,0.017,0.023,0.021,0.042,0.064,0.238,0.554,0.794,0.914,0.963,0.983,0.979,0.982,0.988,0.993,0.990,0.991,0.995,0.995,0.995,0.994,0.995},
{ 0.017,0.012,0.017,0.023,0.021,0.042,0.064,0.238,0.554,0.794,0.914,0.963,0.983,0.979,0.982,0.988,0.993,0.990,0.991,0.995,0.995,0.995,0.994,0.995}
};


//3GeV
/*double large_electron_trigger_e_high_eff[3][24]={
{ 0.020,0.021,0.022,0.044,0.079,0.326,0.654,0.868,0.943,0.987,0.989,0.993,0.991,0.988,0.986,0.991,0.993,0.993,0.992,0.995,0.995,0.995,0.995,0.996},
{ 0.020,0.021,0.022,0.044,0.079,0.326,0.654,0.868,0.943,0.987,0.989,0.993,0.991,0.988,0.986,0.991,0.993,0.993,0.992,0.995,0.995,0.995,0.995,0.996},
{ 0.020,0.021,0.022,0.044,0.079,0.326,0.654,0.868,0.943,0.987,0.989,0.993,0.991,0.988,0.986,0.991,0.993,0.993,0.992,0.995,0.995,0.995,0.995,0.996}


};*/


//3.4GeV
double large_electron_trigger_pi_low_eff[3][24]={ 
{ 0.001,0.003,0.005,0.003,0.006,0.005,0.013,0.007,0.014,0.019,0.037,0.040,0.060,0.061,0.089,0.103,0.132,0.140,0.110,0.152,0.171,0.195,0.218,0.201},{ 0.001,0.000,0.001,0.003,0.000,0.001,0.004,0.004,0.007,0.019,0.024,0.042,0.043,0.060,0.087,0.119,0.130,0.141,0.186,0.163,0.202,0.202,0.243,0.206},{ 0.001,0.000,0.001,0.003,0.000,0.001,0.004,0.004,0.007,0.019,0.024,0.042,0.043,0.060,0.087,0.119,0.130,0.141,0.186,0.163,0.202,0.202,0.243,0.206}
};

//3.3GeV
/*double large_electron_trigger_pi_low_eff[3][24]={ 
{ 0.002,0.003,0.005,0.005,0.007,0.008,0.013,0.010,0.019,0.024,0.046,0.056,0.073,0.077,0.101,0.126,0.150,0.159,0.124,0.178,0.184,0.212,0.246,0.220,},{ 0.001,0.000,0.001,0.004,0.000,0.003,0.007,0.006,0.013,0.029,0.031,0.051,0.058,0.069,0.094,0.138,0.147,0.158,0.199,0.186,0.219,0.215,0.261,0.226,},{ 0.001,0.000,0.001,0.004,0.000,0.003,0.007,0.006,0.013,0.029,0.031,0.051,0.058,0.069,0.094,0.138,0.147,0.158,0.199,0.186,0.219,0.215,0.261,0.226,}
};*/
//3GeV
/*double large_electron_trigger_pi_low_eff[3][24]={
{ 0.002,0.003,0.006,0.005,0.010,0.014,0.028,0.017,0.035,0.045,0.071,0.085,0.111,0.112,0.149,0.176,0.200,0.212,0.176,0.223,0.234,0.242,0.292,0.260,},{ 0.003,0.001,0.001,0.006,0.001,0.006,0.018,0.022,0.038,0.060,0.060,0.099,0.118,0.114,0.149,0.182,0.213,0.209,0.260,0.240,0.283,0.260,0.308,0.286},{ 0.003,0.001,0.001,0.006,0.001,0.006,0.018,0.022,0.038,0.060,0.060,0.099,0.118,0.114,0.149,0.182,0.213,0.209,0.260,0.240,0.283,0.260,0.308,0.286}

};*/

//3.4 GeV
double large_electron_trigger_pi_high_eff[3][24]=  { 
{ 0.003,0.005,0.003,0.006,0.005,0.012,0.007,0.015,0.019,0.039,0.037,0.063,0.061,0.089,0.104,0.129,0.137,0.113,0.156,0.171,0.195,0.224,0.200,0.209},{ 0.000,0.001,0.003,0.000,0.001,0.004,0.004,0.007,0.020,0.027,0.039,0.045,0.058,0.090,0.120,0.132,0.141,0.179,0.170,0.202,0.207,0.239,0.212,0.210},{ 0.000,0.001,0.003,0.000,0.001,0.004,0.004,0.007,0.020,0.027,0.039,0.045,0.058,0.090,0.120,0.132,0.141,0.179,0.170,0.202,0.207,0.239,0.212,0.210}
};

//3.3GeV
/*double large_electron_trigger_pi_high_eff[3][24]=  { 
{ 0.003,0.005,0.005,0.008,0.008,0.013,0.009,0.019,0.023,0.049,0.055,0.074,0.078,0.101,0.128,0.148,0.155,0.127,0.181,0.185,0.212,0.250,0.221,0.234},{ 0.000,0.001,0.004,0.000,0.003,0.007,0.006,0.013,0.030,0.034,0.048,0.061,0.067,0.097,0.137,0.151,0.157,0.192,0.194,0.219,0.221,0.256,0.232,0.232},{ 0.000,0.001,0.004,0.000,0.003,0.007,0.006,0.013,0.030,0.034,0.048,0.061,0.067,0.097,0.137,0.151,0.157,0.192,0.194,0.219,0.221,0.256,0.232,0.232}

};*/
//3 GeV
/*double large_electron_trigger_pi_high_eff[3][24]=  {
{ 0.003,0.006,0.005,0.011,0.015,0.027,0.016,0.038,0.046,0.072,0.086,0.109,0.112,0.151,0.178,0.199,0.210,0.178,0.227,0.233,0.243,0.292,0.263,0.276},{ 0.001,0.001,0.006,0.001,0.006,0.019,0.022,0.039,0.060,0.063,0.099,0.122,0.111,0.152,0.188,0.210,0.208,0.255,0.250,0.284,0.264,0.304,0.292,0.277},{ 0.001,0.001,0.006,0.001,0.006,0.019,0.022,0.039,0.060,0.063,0.099,0.122,0.111,0.152,0.188,0.210,0.208,0.255,0.250,0.284,0.264,0.304,0.292,0.277}

};*/




double get_large_electron_trigger_e_eff(double hit_R, double hit_E){
	double e_eff=0; //return value

	int R_index=-1;
	int P_index=-1;
	
	if(hit_R<large_electron_trigger_low_R[0] || hit_R>large_electron_trigger_high_R[2]){
		e_eff=0;
	}else{
		//get R_index
		for(int Ri=0;Ri<3;Ri++){
			if(hit_R>=large_electron_trigger_low_R[Ri] && hit_R<large_electron_trigger_high_R[Ri]){
				R_index=Ri;
			}
		}
		//cout<<" R index: "<<R_index<<endl;

		if(hit_E<large_electron_trigger_low_P[0]){
			e_eff=0;
		}else{
			//get P index
			
			for(int Pj=0;Pj<=23;Pj++){
				if(hit_E>=large_electron_trigger_low_P[Pj] && hit_E<large_electron_trigger_high_P[Pj]){
					P_index=Pj;
				}
			}

			if(hit_E>=large_electron_trigger_high_P[23]){
				P_index=23;
			}

			//cout<<" P index: "<<P_index<<endl;
		
			//now get R_index and P_index

			//e_eff=0.5*(large_electron_trigger_e_low_eff[R_index][P_index]+large_electron_trigger_e_high_eff[R_index][P_index] );
			 e_eff=(large_electron_trigger_e_high_eff[R_index][P_index] - large_electron_trigger_e_low_eff[R_index][P_index]  )/( large_electron_trigger_high_P[P_index] -  large_electron_trigger_low_P[P_index]) * (hit_E- large_electron_trigger_low_P[P_index]) + large_electron_trigger_e_low_eff[R_index][P_index] ;
		
		}
	}
	return e_eff;
}
		
double get_large_electron_trigger_pi_eff(double hit_R, double hit_E){
	double e_eff=0; //return value

	int R_index=-1;
	int P_index=-1;
	if(hit_R<large_electron_trigger_low_R[0] || hit_R>large_electron_trigger_high_R[2]){
		e_eff=0;
	}else{
		//get R_index
		for(int Ri=0;Ri<3;Ri++){
			if(hit_R>=large_electron_trigger_low_R[Ri] && hit_R<large_electron_trigger_high_R[Ri]){
				R_index=Ri;
			}
		}

		if(hit_E<large_electron_trigger_low_P[0]){
			e_eff=0;
		}else{
			//get P index
			
			for(int Pj=0;Pj<=23;Pj++){
				if(hit_E>=large_electron_trigger_low_P[Pj] && hit_E<large_electron_trigger_high_P[Pj]){
					P_index=Pj;
				}
			}

			if(hit_E>=large_electron_trigger_high_P[23]){
				P_index=23;
			}
		
			//now get R_index and P_index

			//e_eff=0.5*(large_electron_trigger_pi_low_eff[R_index][P_index]+large_electron_trigger_pi_high_eff[R_index][P_index] );
			 e_eff=(large_electron_trigger_pi_high_eff[R_index][P_index] - large_electron_trigger_pi_low_eff[R_index][P_index]  )/( large_electron_trigger_high_P[P_index] -  large_electron_trigger_low_P[P_index]) * (hit_E- large_electron_trigger_low_P[P_index]) + large_electron_trigger_pi_low_eff[R_index][P_index] ;
		
		}
	}
	return e_eff;
}
		
