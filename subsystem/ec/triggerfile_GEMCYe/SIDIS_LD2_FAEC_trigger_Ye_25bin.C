
//Ye Tian Aug. 18,2017 created this function for GEMC SIDIS configuration, the code is based on Rakitha's method.  
//The EM, HallDhadrons, HallDhadrons_winup, and HallDhadrons_windown are the backgrounds considered in this study. 

//Radial binning is 5 see trig_low_R and trig_high_R
//momentum binning is 25 see P_low and P_high

//Routines GetPionTriggerEffi and GetElectronTriggerEffi would return the trigger efficiency when radius index and momentum index (bin index) are passed to them
//The last radius index in the trig_pi_eff and trig_ele_eff gives the trigger efficiency for all radius average

//Use routines GetRadiusIndex and GetMomentumIndex to get the bin index for radius and momentum
//The radius is at the front face of the EC
Double_t trig_low_R[5]={90.0 ,105.0 ,115.0 ,130.0,150.0};
Double_t trig_high_R[5]={105.0 ,115.0 ,130.0 ,150.0,200.0};
Double_t P_low[20] = {0.0}; //momentum in GeV
Double_t P_high[20] = {0.0}; 
//momentum bin from 1GeV~8GeV, bins size 0.28GeV
for(int p_bin=0;p_bin<25;p_bin++){
P_low[p_bin]=1+p_bin*0.28; 
P_high[p_bin]=1.28+p_bin*0.28;
}

Int_t GetRadiusIndex(Double_t radius){
  Int_t Ri=-1;
  for (Int_t i =0; i<5;i++){
    if (radius>trig_low_R[i] && radius<=trig_high_R[i]){
      Ri=i;
      break;
    }
  }
  return Ri;
};
Int_t GetMomentumIndex(Double_t mom){
  Int_t Pi=-1;
  for (Int_t i =0; i<25;i++){
    if (mom>P_low[i] && mom<=P_high[i]){
      Pi=i;
      break;
    }
  }
  return Pi;
};


Double_t GetElectronTriggerEffi(Int_t rad_index, Int_t mom_index){
Double_t trig_ele_eff[6][25] = { { 0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.009,0.028,0.255,0.802,0.973,0.971,0.990,1.000,1.000,0.991,0.992,0.992,1.000,1.000,1.000},{ 0.002,0.000,0.003,0.000,0.006,0.000,0.007,0.004,0.184,0.728,0.976,0.989,0.993,0.992,0.997,0.993,0.996,0.996,0.989,0.993,1.000,0.996,1.000,1.000,1.000},{ 0.005,0.002,0.002,0.007,0.015,0.300,0.851,0.982,0.995,1.000,0.996,0.998,0.998,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.008,0.016,0.414,0.938,0.992,0.996,0.999,0.999,0.998,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.928,0.995,1.000,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.198,0.370,0.557,0.698,0.737,0.789,0.873,0.880,0.877,0.923,0.937,0.942,0.944,0.958,0.963,0.965,0.960,0.968,0.965,0.962,0.969,0.964,0.964,0.962,0.967}}; 
  if (rad_index!= -1 && mom_index!=-1)
    return trig_pi_eff[rad_index][mom_index];
  else
    return 0;  
};

Double_t GetElectronTriggerEffiError(Int_t rad_index, Int_t mom_index){
  Double_t trig_ele_eff_err[6][25] = { { 0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.009,0.016,0.042,0.039,0.015,0.016,0.010,0.000,0.000,0.009,0.008,0.008,0.000,0.000,0.000},{ 0.002,0.000,0.003,0.000,0.005,0.000,0.005,0.004,0.023,0.028,0.009,0.006,0.005,0.005,0.003,0.005,0.004,0.004,0.006,0.005,0.000,0.004,0.000,0.000,0.000},{ 0.003,0.002,0.002,0.004,0.005,0.021,0.018,0.006,0.003,0.000,0.003,0.002,0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.003,0.004,0.018,0.008,0.003,0.002,0.001,0.001,0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.010,0.002,0.000,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.007,0.008,0.008,0.008,0.007,0.007,0.006,0.005,0.006,0.004,0.004,0.004,0.004,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003}}; 
  if (rad_index!= -1 && mom_index!=-1)
    return trig_pi_eff_err[rad_index][mom_index];
  else
    return 0;  
};

Double_t GetPionTriggerEffi(Int_t rad_index, Int_t mom_index){
  Double_t trig_pi_eff[6][25] = { { 0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.021,0.023,0.036,0.041,0.079,0.170,0.109,0.153,0.198,0.205,0.126},{ 0.000,0.006,0.000,0.003,0.000,0.000,0.000,0.000,0.000,0.007,0.012,0.028,0.046,0.130,0.098,0.158,0.135,0.170,0.237,0.241,0.234,0.262,0.278,0.261,0.346},{ 0.003,0.004,0.003,0.005,0.004,0.004,0.025,0.052,0.067,0.155,0.171,0.179,0.228,0.221,0.256,0.270,0.338,0.357,0.327,0.339,0.374,0.382,0.458,0.384,0.398},{ 0.010,0.018,0.052,0.087,0.148,0.201,0.277,0.299,0.341,0.354,0.397,0.391,0.438,0.435,0.436,0.426,0.468,0.465,0.485,0.513,0.517,0.504,0.475,0.506,0.495},{ 0.252,0.364,0.404,0.456,0.493,0.524,0.531,0.544,0.541,0.559,0.563,0.578,0.539,0.566,0.546,0.565,0.570,0.578,0.554,0.603,0.548,0.583,0.572,0.583,0.595},{ 0.061,0.143,0.188,0.237,0.291,0.322,0.353,0.369,0.374,0.393,0.415,0.412,0.414,0.431,0.424,0.437,0.457,0.464,0.450,0.490,0.465,0.487,0.485,0.490,0.499}}; 
  if (rad_index!= -1 && mom_index!=-1)
    return trig_ele_eff[rad_index][mom_index];
  else
    return 0;
};

Double_t GetPionTriggerEffiError(Int_t rad_index, Int_t mom_index){
  Double_t trig_pi_eff_err[6][25] = { { 0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.015,0.013,0.018,0.018,0.025,0.040,0.029,0.033,0.036,0.038,0.032},{ 0.000,0.004,0.000,0.003,0.000,0.000,0.000,0.000,0.000,0.005,0.007,0.010,0.014,0.021,0.018,0.024,0.021,0.024,0.025,0.025,0.026,0.028,0.027,0.027,0.029},{ 0.002,0.003,0.002,0.003,0.003,0.003,0.007,0.011,0.012,0.017,0.019,0.019,0.020,0.020,0.021,0.022,0.024,0.023,0.022,0.022,0.024,0.023,0.024,0.024,0.023},{ 0.003,0.005,0.008,0.010,0.013,0.015,0.017,0.018,0.018,0.019,0.019,0.019,0.020,0.020,0.020,0.019,0.019,0.020,0.020,0.020,0.020,0.019,0.019,0.020,0.019},{ 0.016,0.014,0.013,0.012,0.012,0.012,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011,0.011},{ 0.004,0.006,0.007,0.007,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.009,0.008,0.009,0.008,0.009,0.008,0.009,0.008}};
  if (rad_index!= -1 && mom_index!=-1)
    return trig_ele_eff_err[rad_index][mom_index];
  else
    return 0;
};
