
//Ye Tian Aug. 18,2017 created this function for GEMC SIDIS configuration, the code is based on Rakitha's method.  
//The EM, HallDhadrons, HallDhadrons_winup, and HallDhadrons_windown are the backgrounds considered in this study. 

//Radial binning is 5 see trig_low_R and trig_high_R
//momentum binning is 20 see P_low and P_high

//Routines GetPionTriggerEffi and GetElectronTriggerEffi would return the trigger efficiency when radius index and momentum index (bin index) are passed to them
//The last radius index in the trig_pi_eff and trig_ele_eff gives the trigger efficiency for all radius average

//Use routines GetRadiusIndex and GetMomentumIndex to get the bin index for radius and momentum
//The radius is at the front face of the EC
Double_t trig_low_R[5]={90.0 ,105.0 ,115.0 ,130.0,150.0};
Double_t trig_high_R[5]={105.0 ,115.0 ,130.0 ,150.0,200.0};
Double_t P_low[20] = {0.0}; //momentum in GeV
Double_t P_high[20] = {0.0}; 
//momentum bin from 1GeV~8GeV, bins size 0.35GeV
for(int p_bin=0;p_bin<20;p_bin++){
P_low[p_bin]=1+p_bin*0.35; 
P_high[p_bin]=1.35+p_bin*0.35;
}

Int_t GetRadiusIndex(Double_t radius){
  Int_t Ri=-1;
  for (Int_t i =0; i<5;i++){
    if (radius>trig_low_R[i] && radius<=trig_high_R[i]){
      Ri=i;
      break;
    }
  }
  return Ri;
};
Int_t GetMomentumIndex(Double_t mom){
  Int_t Pi=-1;
  for (Int_t i =0; i<20;i++){
    if (mom>P_low[i] && mom<=P_high[i]){
      Pi=i;
      break;
    }
  }
  return Pi;
};


Double_t GetElectronTriggerEffi(Int_t rad_index, Int_t mom_index){
  Double_t trig_ele_eff[6][20] = { { 0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.014,0.096,0.617,0.969,0.977,0.993,1.000,0.993,0.987,1.000,1.000,1.000},{ 0.002,0.002,0.000,0.005,0.000,0.006,0.080,0.652,0.975,0.991,0.994,0.997,0.994,0.997,0.989,0.994,0.997,1.000,1.000,1.000},{ 0.004,0.001,0.006,0.014,0.381,0.922,0.989,1.000,0.996,0.998,0.998,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.010,0.078,0.802,0.989,0.997,0.999,0.997,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.947,0.998,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.228,0.425,0.658,0.736,0.808,0.875,0.873,0.918,0.936,0.943,0.953,0.963,0.963,0.964,0.967,0.962,0.968,0.965,0.964,0.965}};
  if (rad_index!= -1 && mom_index!=-1)
    return trig_ele_eff[rad_index][mom_index];
  else
    return 0;  
};

Double_t GetElectronTriggerEffiError(Int_t rad_index, Int_t mom_index){
  Double_t trig_ele_eff_err[6][20] = { { 0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.010,0.025,0.042,0.015,0.013,0.007,0.000,0.007,0.009,0.000,0.000,0.000},{ 0.002,0.002,0.000,0.004,0.000,0.004,0.015,0.027,0.008,0.005,0.004,0.003,0.004,0.003,0.006,0.004,0.003,0.000,0.000,0.000},{ 0.002,0.001,0.003,0.005,0.021,0.012,0.004,0.000,0.003,0.002,0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.003,0.008,0.013,0.003,0.002,0.001,0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.007,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.006,0.007,0.007,0.007,0.006,0.005,0.005,0.004,0.004,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003,0.003}}; 
  if (rad_index!= -1 && mom_index!=-1)
    return trig_ele_eff_err[rad_index][mom_index];
  else
    return 0;  
};

Double_t GetPionTriggerEffi(Int_t rad_index, Int_t mom_index){
  Double_t trig_pi_eff[6][20] = { { 0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.016,0.024,0.046,0.055,0.150,0.119,0.198,0.152,0.158},{ 0.000,0.004,0.000,0.003,0.000,0.000,0.000,0.006,0.020,0.031,0.095,0.107,0.155,0.140,0.219,0.241,0.235,0.266,0.275,0.328},{ 0.003,0.004,0.004,0.005,0.005,0.045,0.053,0.138,0.169,0.210,0.218,0.247,0.277,0.348,0.352,0.328,0.371,0.429,0.400,0.397},{ 0.009,0.032,0.072,0.140,0.211,0.282,0.338,0.348,0.399,0.395,0.454,0.430,0.438,0.468,0.484,0.496,0.517,0.474,0.506,0.501},{ 0.298,0.356,0.447,0.490,0.528,0.532,0.552,0.548,0.564,0.566,0.561,0.543,0.568,0.569,0.569,0.589,0.549,0.587,0.579,0.589},{ 0.079,0.150,0.224,0.284,0.328,0.355,0.381,0.386,0.413,0.413,0.430,0.419,0.441,0.458,0.464,0.475,0.468,0.490,0.487,0.497}};
  if (rad_index!= -1 && mom_index!=-1)
    return trig_pi_eff[rad_index][mom_index];
  else
    return 0;
};

Double_t GetPionTriggerEffiError(Int_t rad_index, Int_t mom_index){
  Double_t trig_pi_eff_err[6][20] = { { 0.002,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.011,0.012,0.018,0.019,0.033,0.027,0.031,0.031,0.031},{ 0.000,0.003,0.000,0.003,0.000,0.000,0.000,0.004,0.008,0.009,0.017,0.017,0.021,0.019,0.023,0.022,0.023,0.025,0.024,0.026},{ 0.002,0.002,0.002,0.003,0.003,0.009,0.010,0.015,0.016,0.018,0.018,0.018,0.020,0.021,0.020,0.020,0.021,0.022,0.021,0.021},{ 0.003,0.006,0.008,0.012,0.014,0.015,0.017,0.017,0.017,0.017,0.018,0.018,0.017,0.017,0.018,0.018,0.017,0.017,0.018,0.017},{ 0.015,0.012,0.011,0.011,0.011,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010,0.010},{ 0.004,0.006,0.006,0.007,0.007,0.007,0.007,0.007,0.008,0.008,0.008,0.007,0.007,0.008,0.008,0.008,0.008,0.008,0.008,0.008}};
  if (rad_index!= -1 && mom_index!=-1)
    return trig_pi_eff_err[rad_index][mom_index];
  else
    return 0;
};
